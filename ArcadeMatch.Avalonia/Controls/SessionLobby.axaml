<UserControl
    x:Class="ArcadeMatch.Avalonia.Controls.SessionLobby"
    x:DataType="sessionVm:SessionLobbyViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:sessionVm="clr-namespace:ArcadeMatch.Avalonia.ViewModels.Sessions"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <StackPanel
            HorizontalAlignment="Center"
            Spacing="15"
            VerticalAlignment="Center"
            Width="500">
            <TextBlock
                FontSize="20"
                FontWeight="Bold"
                HorizontalAlignment="Center"
                Text="Session Lobby" />
            <Border
                Background="#0078D4"
                CornerRadius="10"
                Margin="0,0,0,10"
                Padding="15,10">
                <StackPanel
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="10">
                    <TextBlock
                        FontSize="16"
                        FontWeight="Bold"
                        Foreground="White"
                        Text="{Binding SessionId, StringFormat=Session Code: {0}}" />
                    <Button Command="{Binding CopyCodeCommand}" Content="ðŸ“‹ Copy" />
                </StackPanel>
            </Border>
            <ListBox
                ItemsSource="{Binding Users}"
                MinHeight="120"
                SelectionMode="Single">
                <ListBox.ItemTemplate>
                    <DataTemplate x:DataType="sessionVm:SessionLobbyViewModel+UserEntryViewModel">
                        <TextBlock Margin="5" Text="{Binding DisplayName}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
            <!--  Matching options (admin-configurable)  -->
            <Border
                CornerRadius="6"
                Margin="0,5,0,0"
                Padding="10">
                <StackPanel Spacing="8">
                    <TextBlock FontWeight="Bold" Text="Matching Options" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock
                            Text="Min owners:"
                            VerticalAlignment="Center"
                            Width="100" />
                        <Slider
                            IsEnabled="{Binding IsAdmin}"
                            IsSnapToTickEnabled="True"
                            Maximum="{Binding LobbyUserCount}"
                            Minimum="0"
                            TickFrequency="1"
                            Value="{Binding MinOwners}"
                            Width="260"
                            x:Name="MinOwnersSlider" />
                        <TextBlock
                            HorizontalAlignment="Center"
                            Text="{Binding Value, ElementName=MinOwnersSlider}"
                            Width="30" />
                    </StackPanel>
                    <CheckBox
                        Content="Include wishlisted games"
                        IsChecked="{Binding IncludeWishlist}"
                        IsEnabled="{Binding IsAdmin}"
                        x:Name="IncludeWishlistCheckbox" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock
                            Text="Min wishlisted:"
                            VerticalAlignment="Center"
                            Width="100" />
                        <Slider
                            IsEnabled="{Binding IsWishlistSliderEnabled}"
                            IsSnapToTickEnabled="True"
                            Maximum="{Binding LobbyUserCount}"
                            Minimum="0"
                            TickFrequency="1"
                            Value="{Binding MinWishlisted}"
                            Width="260"
                            x:Name="MinWishlistedSlider" />
                        <TextBlock
                            HorizontalAlignment="Center"
                            Text="{Binding Value, ElementName=MinWishlistedSlider}"
                            Width="30" />
                    </StackPanel>
                    <TextBlock
                        FontSize="11"
                        Foreground="#666"
                        Text="Tip: Set any threshold to 0 to ignore it." />
                </StackPanel>
            </Border>
            <StackPanel
                HorizontalAlignment="Center"
                Orientation="Horizontal"
                Spacing="10">
                <Button Command="{Binding LeaveCommand}" Content="ðŸšª Leave" />
                <Button
                    Command="{Binding StartCommand}"
                    Content="ðŸš€ Start Game"
                    IsEnabled="{Binding IsAdmin}" />
            </StackPanel>
        </StackPanel>
    </Grid>
</UserControl>

