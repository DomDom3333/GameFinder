<UserControl
    x:Class="ArcadeMatch.Avalonia.Controls.Tabs"
    x:DataType="vm:TabsViewModel"
    xmlns="https://github.com/avaloniaui"
    xmlns:controls="clr-namespace:ArcadeMatch.Avalonia.Controls"
    xmlns:converters="clr-namespace:ArcadeMatch.Avalonia.Converters"
    xmlns:sessionVm="clr-namespace:ArcadeMatch.Avalonia.ViewModels.Sessions"
    xmlns:vm="clr-namespace:ArcadeMatch.Avalonia.ViewModels.Tabs"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <converters:IsLoggedInToBrushConverter x:Key="IsLoggedInToBrushConverter" />
    </UserControl.Resources>
    <UserControl.DataTemplates>
        <DataTemplate DataType="{x:Type vm:SettingsTabViewModel}">
            <controls:SettingsTabView />
        </DataTemplate>
        <DataTemplate DataType="{x:Type sessionVm:SessionStartViewModel}">
            <controls:SessionStart />
        </DataTemplate>
        <DataTemplate DataType="{x:Type sessionVm:SessionLobbyViewModel}">
            <controls:SessionLobby />
        </DataTemplate>
        <DataTemplate DataType="{x:Type sessionVm:SwipingViewModel}">
            <controls:Swiping />
        </DataTemplate>
        <DataTemplate DataType="{x:Type sessionVm:MatchResultViewModel}">
            <controls:MatchResult />
        </DataTemplate>
    </UserControl.DataTemplates>
    <TabControl>
        <TabItem Header="Home">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="20" Spacing="20">
                    <StackPanel Spacing="8">
                        <TextBlock
                            FontSize="20"
                            FontWeight="Bold"
                            HorizontalAlignment="Center"
                            Text="Steam Authentication" />
                        <TextBlock
                            FontWeight="Bold"
                            Text="Recommended: Use Steam API credentials" />
                        <TextBlock
                            Text="Provide your Steam API key and Steam ID to fetch your library without launching a browser." />
                    </StackPanel>
                    <StackPanel Spacing="8">
                        <TextBlock Text="ðŸ” Steam API Key" />
                        <TextBox Text="{Binding Home.SteamApiKey, Mode=TwoWay}" />
                        <TextBlock Text="ðŸ†” Steam ID" />
                        <TextBox Text="{Binding Home.SteamId, Mode=TwoWay}" />
                        <Button
                            Command="{Binding Home.FetchViaApiCommand}"
                            Content="ðŸ”„ Fetch via API"
                            HorizontalAlignment="Center" />
                    </StackPanel>
                    <StackPanel Spacing="8">
                        <TextBlock Margin="0,0,0,2" Text="ðŸ” Authentication Status" />
                        <Border
                            Background="{Binding Home.IsLoggedIn, Converter={StaticResource IsLoggedInToBrushConverter}}"
                            CornerRadius="15"
                            Margin="0,0,15,0"
                            Padding="15,8">
                            <StackPanel Orientation="Horizontal">
                                <Ellipse
                                    Fill="White"
                                    Height="12"
                                    Margin="0,0,8,0"
                                    Width="12" />
                                <TextBlock
                                    FontWeight="Bold"
                                    Foreground="White"
                                    Text="{Binding Home.ConnectionStatus}" />
                            </StackPanel>
                        </Border>
                    </StackPanel>
                    <Expander Header="Advanced: Use web login (not recommended)" IsExpanded="False">
                        <StackPanel Margin="10,5,0,0" Spacing="10">
                            <StackPanel>
                                <TextBlock Text="1ï¸âƒ£ Click the login button below" />
                                <TextBlock Text="2ï¸âƒ£ Complete Steam authentication in browser" />
                                <TextBlock Text="3ï¸âƒ£ Click refresh to verify login status" />
                                <TextBlock Text="4ï¸âƒ£ Keep browser open until verification is complete" />
                            </StackPanel>
                            <StackPanel
                                HorizontalAlignment="Center"
                                Orientation="Horizontal"
                                Spacing="10">
                                <Button Command="{Binding Home.LoginCommand}" Content="ðŸ”‘ Login to Steam" />
                                <Button Command="{Binding Home.RefreshCommand}" Content="ðŸ”„ Refresh Status" />
                            </StackPanel>
                        </StackPanel>
                    </Expander>
                </StackPanel>
            </ScrollViewer>
        </TabItem>
        <TabItem Header="Session">
            <ContentControl Content="{Binding SelectedSession}" />
        </TabItem>
        <TabItem Header="Settings">
            <ContentControl Content="{Binding Settings}" />
        </TabItem>
    </TabControl>
</UserControl>
